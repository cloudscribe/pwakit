const PushNotificationSettings=function(){function f(){var u=document.querySelectorAll("[data-push-subscribe-button]"),f,r,s;for(i=0;i<u.length;++i)f=u[i],f.addEventListener("click",e);for(r=document.querySelectorAll("[data-push-unsubscribe-button]"),i=0;i<r.length;++i)s=r[i],s.addEventListener("click",o);n.pushManager.getSubscription().then(function(n){if(t(Notification.permission==="denied",n!==null),Notification.permission==="denied"){var r=document.querySelectorAll("[data-show-if-push-not-supported]");for(i=0;i<r.length;++i)r[i].style.display="block"}(Notification.permission!=="denied",n!==null)&&(console.log("found subscription"),console.log(n),PushNotificationsController.storePushSubscription(n).then(function(n){n.ok?console.log("Successfully saved subscription"):console.log("Failed to uppdate subscription")}).catch(function(n){console.log("Failed to update subscription on server: "+n)}))})}function t(n,t){var e=document.querySelectorAll("[data-push-subscribe-button]"),o,u,s,f,r;for(i=0;i<e.length;++i)o=e[i],o.style.display=n||t?"none":"inline-block";for(u=document.querySelectorAll("[data-push-unsubscribe-button]"),i=0;i<u.length;++i)s=u[i],s.style.display=n||!t?"none":"block";for(f=document.querySelectorAll("[data-show-if-not-push-subscribed]"),i=0;i<f.length;++i)r=f[i],n||!t?(r.style.display="block",r.classList.add("show")):(r.style.display="none",r.classList.remove("show"))}function e(){r?u():PushNotificationsController.retrievePublicKey().then(function(n){r=n;u()}).catch(function(n){console.log(n)})}function u(){n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}).then(function(n){PushNotificationsController.storePushSubscription(n).then(function(n){n.ok?console.log("Successfully subscribed for Push Notifications"):console.log("Failed to store the Push Notifications subscrition on server")}).catch(function(n){console.log("Failed to store the Push Notifications subscrition on server: "+n)});t(!1,!0)}).catch(function(n){Notification.permission==="denied"?t(!0,!1):console.log("Failed to subscribe for Push Notifications: "+n)})}function o(){n.pushManager.getSubscription().then(function(n){n&&n.unsubscribe().then(function(){PushNotificationsController.discardPushSubscription(n).then(function(n){n.ok?console.log("Successfully unsubscribed from Push Notifications"):console.log("Failed to discard the Push Notifications subscrition from server")}).catch(function(n){console.log("Failed to discard the Push Notifications subscrition from server: "+n)});t(!1,!1)}).catch(function(n){console.log("Failed to unsubscribe from Push Notifications: "+n)})})}let r,n;return{initialize:function(t){n=t;n?(console.log("found registration"),f()):console.log("registration not found")}}}();document.addEventListener("DOMContentLoaded",function(){if("serviceWorker"in navigator&&"PushManager"in window)navigator.serviceWorker.ready.then(function(n){PushNotificationSettings.initialize(n)});else if(!("PushManager"in window)){console.log("push not supported");var n=document.querySelectorAll("[data-show-if-push-not-supported]");for(i=0;i<n.length;++i)n[i].style.display="block"}});